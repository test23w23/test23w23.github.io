<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìå –î–æ—Å–∫–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
        body { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            min-height: 100vh; padding: 20px; 
        }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { text-align: center; color: white; margin-bottom: 30px; font-size: 2.5em; }
        .upload-zone { 
            background: white; border: 3px dashed #ccc; border-radius: 15px; 
            padding: 40px; text-align: center; cursor: pointer; margin-bottom: 30px; 
            transition: all 0.3s;
        }
        .upload-zone:hover, .upload-zone.drag { 
            border-color: #ff6b6b; background: #ffeaea; transform: scale(1.02); 
        }
        .upload-zone p { font-size: 1.3em; color: #666; margin: 10px 0; }
        .controls { 
            background: white; border-radius: 15px; padding: 20px; margin-bottom: 30px; 
            text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .btn { 
            background: #ff6b6b; color: white; border: none; padding: 12px 30px; 
            border-radius: 25px; font-size: 1.1em; cursor: pointer; margin: 0 10px;
            transition: all 0.3s;
        }
        .btn:hover { background: #ff5252; transform: translateY(-2px); }
        input[type="file"] { display: none; }
        .board { 
            background: white; border-radius: 15px; padding: 30px; 
            display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); 
            gap: 20px; 
        }
        .file-item { 
            border: 2px solid #eee; border-radius: 10px; padding: 20px; 
            text-align: center; cursor: pointer; transition: all 0.3s;
        }
        .file-item:hover { 
            border-color: #ff6b6b; transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .file-thumb { font-size: 3em; margin-bottom: 15px; }
        .file-name { font-weight: bold; margin-bottom: 5px; font-size: 1.1em; }
        .file-size { color: #888; font-size: 0.9em; }
        .count { 
            position: fixed; top: 20px; right: 20px; 
            background: rgba(255,255,255,0.9); padding: 15px 25px; border-radius: 25px; 
            font-weight: bold; color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìå –î–æ—Å–∫–∞ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π</h1>
        <div class="count" id="count">–§–∞–π–ª–æ–≤: 0</div>
        
        <div class="controls">
            <button class="btn" onclick="downloadAll()">üì¶ –°–∫–∞—á–∞—Ç—å –≤—Å–µ ZIP</button>
            <button class="btn" onclick="clearAll()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –¥–æ—Å–∫—É</button>
            <label class="btn" for="restoreInput">üìÅ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</label>
            <input type="file" id="restoreInput" accept=".json" style="display:none">
        </div>
        
        <div class="upload-zone" id="uploadZone">
            <p>üìÅ –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ PDF, PPT —Å—é–¥–∞</p>
            <p style="font-size: 1.1em; color: #333;">–∏–ª–∏ –∫–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ (–¥–æ 20 –ú–ë)</p>
            <input type="file" id="fileInput" multiple accept=".pdf,.ppt,.pptx">
        </div>
        
        <div class="board" id="board"></div>
    </div>

    <script>
        const zone = document.getElementById('uploadZone');
        const input = document.getElementById('fileInput');
        const restoreInput = document.getElementById('restoreInput');
        const board = document.getElementById('board');
        const count = document.getElementById('count');
        
        let files = [];

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ localStorage
        function loadFiles() {
            try {
                const saved = localStorage.getItem('padletFiles');
                if (saved) {
                    files = JSON.parse(saved).map(f => ({
                        ...f,
                        url: f.url // URL.createObjectURL –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
                    }));
                }
            } catch(e) {
                console.log('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª—ã');
            }
            render();
        }

        // Drag & Drop
        zone.addEventListener('dragover', e => {
            e.preventDefault();
            zone.classList.add('drag');
        });
        
        zone.addEventListener('dragleave', e => {
            e.preventDefault();
            zone.classList.remove('drag');
        });
        
        zone.addEventListener('drop', e => {
            e.preventDefault();
            zone.classList.remove('drag');
            addFiles(e.dataTransfer.files);
        });
        
        zone.addEventListener('click', () => input.click());
        
        input.addEventListener('change', e => {
            addFiles(e.target.files);
            input.value = '';
        });

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
        function addFiles(fileList) {
            for (let file of Array.from(fileList)) {
                if (!/\.(pdf|ppt|pptx)$/i.test(file.name)) {
                    alert('–¢–æ–ª—å–∫–æ PDF, PPT, PPTX');
                    continue;
                }
                if (file.size > 20*1024*1024) {
                    alert(file.name + ' > 20MB');
                    continue;
                }
                
                const fileURL = URL.createObjectURL(file);
                files.unshift({
                    name: file.name,
                    size: file.size,
                    url: fileURL,
                    date: Date.now()
                });
                
                if (files.length > 50) files = files.slice(0, 50);
                saveFiles();
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        function saveFiles() {
            localStorage.setItem('padletFiles', JSON.stringify(files));
            render();
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
        function render() {
            board.innerHTML = '';
            files.slice(0, 30).forEach(fileData => {
                const item = document.createElement('div');
                item.className = 'file-item';
                item.innerHTML = `
                    <div class="file-thumb">${getIcon(fileData.name)}</div>
                    <div class="file-name">${fileData.name}</div>
                    <div class="file-size">${formatSize(fileData.size)}</div>
                `;
                item.onclick = () => window.open(fileData.url, '_blank');
                board.appendChild(item);
            });
            count.textContent = `–§–∞–π–ª–æ–≤: ${files.length}`;
        }

        function getIcon(name) {
            const ext = name.split('.').pop().toLowerCase();
            return {pdf: 'üìÑ', ppt: 'üìä', pptx: 'üìä'}[ext] || 'üìé';
        }

        function formatSize(bytes) {
            if (bytes < 1024) return bytes + ' –ë';
            if (bytes < 1024*1024) return Math.round(bytes/1024) + ' –ö–ë';
            return (bytes/1024/1024).toFixed(1) + ' –ú–ë';
        }

        // üî• –°–ö–ê–ß–ê–¢–¨ –í–°–ï –§–ê–ô–õ–´ ZIP
        function downloadAll() {
            if (files.length === 0) {
                alert('–ù–µ—Ç —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è');
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è JSON —Å–æ —Å–ø–∏—Å–∫–æ–º —Ñ–∞–π–ª–æ–≤
            const dataStr = JSON.stringify(files.map(f => ({
                name: f.name,
                size: f.size,
                date: new Date(f.date).toLocaleString('ru-RU')
            })), null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `–¥–æ—Å–∫–∞-–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–π-${new Date().toISOString().slice(0,10)}.json`;
            link.click();
            
            alert(`üì¶ –°–∫–∞—á–∞–Ω —Ñ–∞–π–ª —Å–æ —Å–ø–∏—Å–∫–æ–º ${files.length} —Ñ–∞–π–ª–æ–≤!\nüíæ –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ - –¥–æ–º–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ —Ç—É –∂–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É!`);
        }

        // üî• –û–ß–ò–°–¢–ò–¢–¨
        function clearAll() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã?')) {
                files = [];
                localStorage.removeItem('padletFiles');
                render();
            }
        }

        // üî• –í–û–°–°–¢–ê–ù–û–í–ò–¢–¨
        restoreInput.addEventListener('change', e => {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = e => {
                try {
                    const data = JSON.parse(e.target.result);
                    files = data;
                    saveFiles();
                    alert('–§–∞–π–ª—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã!');
                } catch(err) {
                    alert('–û—à–∏–±–∫–∞ —Ñ–∞–π–ª–∞');
                }
            };
            reader.readAsText(file);
        });

        // ‚≠ê –°–¢–ê–†–¢
        loadFiles();
    </script>
</body>
</html>





